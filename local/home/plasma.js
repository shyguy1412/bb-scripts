var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __name = (target, value) => __defProp(target, "name", { value, configurable: true });
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));

// react:react
var require_react = __commonJS({
  "react:react"(exports, module) {
    module.exports = React;
  }
});

// react:react-dom
var require_react_dom = __commonJS({
  "react:react-dom"(exports, module) {
    module.exports = ReactDOM;
  }
});

// src/apps/Plasma/assets/bitburner-logo.svg
var bitburner_logo_default = '<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<!-- Created with Inkscape (http://www.inkscape.org/) -->\n\n<svg\n   width="100%"\n   height="100%"\n   viewBox="0 0 8.4666665 8.4666669"\n   version="1.1"\n   id="svg5"\n   inkscape:version="1.1.1 (c3084ef, 2021-09-22)"\n   sodipodi:docname="bb.svg"\n   inkscape:export-filename="/Users/hydroflame/Desktop/bb128x128.png"\n   inkscape:export-xdpi="384.00003"\n   inkscape:export-ydpi="384.00003"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <sodipodi:namedview\n     id="namedview7"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:pageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:document-units="mm"\n     showgrid="true"\n     units="px"\n     inkscape:zoom="11.313709"\n     inkscape:cx="-15.291184"\n     inkscape:cy="12.904699"\n     inkscape:window-width="2533"\n     inkscape:window-height="1176"\n     inkscape:window-x="316"\n     inkscape:window-y="81"\n     inkscape:window-maximized="0"\n     inkscape:current-layer="layer3">\n    <inkscape:grid\n       type="xygrid"\n       id="grid34424" />\n  </sodipodi:namedview>\n  <defs\n     id="defs2" />\n  <g\n     inkscape:groupmode="layer"\n     id="layer3"\n     inkscape:label="icon"\n     style="display:inline">\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="m 4.2333333,1.0583333 v 3.96875 l -0.5291666,0.79375 v 0.79375 L 4.2333333,7.14375 v 0.2645834"\n       id="path1456"\n       sodipodi:nodetypes="cccccc" />\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 4.2333333,5.0270833 4.7625,5.8208333 v 0.79375 L 4.2333333,7.14375"\n       id="path1524"\n       sodipodi:nodetypes="cccc" />\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 2.9104166,7.4083332 V 5.5562499 l 0.5291667,-0.79375 V 3.7041666 l 0.79375,-1.3229167"\n       id="path3458"\n       sodipodi:nodetypes="ccccc" />\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 5.5562499,7.4083332 V 5.5562499 L 5.0270833,4.7624999 V 3.7041666 L 4.2333334,2.3812499"\n       id="path3460"\n       sodipodi:nodetypes="ccccc" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 1.8520833,6.6145833 V 4.7625 L 2.1166666,4.4979166 2.38125,4.2333333 2.9104167,3.7041667 l 0.5291666,-10e-8"\n       id="path3619"\n       sodipodi:nodetypes="cccccc" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="m 6.6145835,6.6145832 -1e-7,-1.8520833 L 6.35,4.4979166 6.0854167,4.2333332 5.5562501,3.7041666 H 5.0270833"\n       id="path3621"\n       sodipodi:nodetypes="cccccc" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.216031;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 2.9104166,5.55625 H 1.8520832"\n       id="path3623"\n       sodipodi:nodetypes="cc" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.216031;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 5.4239583,5.4239583 H 6.4822916"\n       id="path3625" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 4.7625,3.175 5.0270834,2.9104167 v -1.5875"\n       id="path3670"\n       sodipodi:nodetypes="ccc" />\n    <path\n       style="display:inline;fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 3.7041666,3.175 3.4395832,2.9104167 v -1.5875"\n       id="path3672"\n       sodipodi:nodetypes="ccc" />\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 6.0854167,7.4083333 6.6145833,6.8791667 V 6.35 l 0.79375,-0.79375 V 2.1166667"\n       id="path4789"\n       sodipodi:nodetypes="ccccc" />\n    <path\n       style="fill:none;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 2.38125,7.4083333 1.8520833,6.8791666 V 6.35 L 1.0583333,5.55625 V 2.1166666"\n       id="path5224"\n       sodipodi:nodetypes="ccccc" />\n    <path\n       style="fill:none;fill-opacity:1;stroke:var(--primarylight);stroke-width:0.280633;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 2.6458333,3.96875 V 1.5875"\n       id="path20342"\n       sodipodi:nodetypes="cc" />\n    <path\n       style="fill:none;fill-opacity:1;stroke:var(--primarylight);stroke-width:0.280633;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="M 5.8208333,3.96875 V 1.5875"\n       id="path20410"\n       sodipodi:nodetypes="cc" />\n    <path\n       style="fill:none;fill-opacity:1;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="m 1.0583333,4.2333333 0.79375,-0.79375 v -1.5875"\n       id="path20544"\n       sodipodi:nodetypes="ccc" />\n    <path\n       style="fill:none;fill-opacity:1;stroke:var(--primarylight);stroke-width:0.264583;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"\n       d="m 7.4083332,4.2333333 -0.7937499,-0.79375 -10e-8,-1.5875"\n       id="path20546"\n       sodipodi:nodetypes="ccc" />\n  </g>\n</svg>';

// src/lib/Context.tsx
var import_react = __toESM(require_react());
var NetscriptContext = (0, import_react.createContext)(null);
var CleanupContext = (0, import_react.createContext)(null);
var TerminateContext = (0, import_react.createContext)(null);
var TailRootContext = (0, import_react.createContext)(null);

// src/lib/BitburnerDOM.ts
function watchElForDeletion(elToWatch, callback) {
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      if (mutation.type === "childList") {
        mutation.removedNodes.forEach((node) => {
          if (!containsRecursive(node, elToWatch)) return;
          callback();
          observer.disconnect();
        });
      }
    });
  });
  observer.observe(document.body, { childList: true, subtree: true });
  return {
    cleanup: /* @__PURE__ */ __name(() => observer.disconnect(), "cleanup")
  };
}
__name(watchElForDeletion, "watchElForDeletion");
function watchSelectorForCreation(selector, callback) {
  const observer = new MutationObserver(function(mutations) {
    mutations.forEach(function(mutation) {
      const element = [...mutation.addedNodes].reduce((prev, cur) => {
        if (cur.nodeType != cur.ELEMENT_NODE) return prev;
        const added = cur.matches(selector) ? cur : cur.querySelector(selector);
        return prev ?? added;
      }, null);
      if (element) {
        callback(element);
        observer.disconnect();
      }
    });
  });
  observer.observe(document.body, { childList: true, subtree: true });
  return {
    cleanup: /* @__PURE__ */ __name(() => observer.disconnect(), "cleanup")
  };
}
__name(watchSelectorForCreation, "watchSelectorForCreation");
function containsRecursive(container, child) {
  if (!("children" in container)) return false;
  return [...container.children].reduce((prev, cur) => prev || cur == child || containsRecursive(cur, child), false);
}
__name(containsRecursive, "containsRecursive");

// src/lib/System.ts
async function sleep(ms) {
  await new Promise((resolve) => setTimeout(() => resolve(), ms));
}
__name(sleep, "sleep");

// src/lib/Terminal.ts
var Terminal = class extends EventTarget {
  static {
    __name(this, "Terminal");
  }
  cleanupMap = {};
  terminalInput = null;
  terminalElement = null;
  #terminalInputProps = null;
  #awaitConnectQueue = [];
  constructor(ns) {
    super();
    const onDisconnect = /* @__PURE__ */ __name(() => {
      const { cleanup } = watchSelectorForCreation("#terminal-input", () => {
        onConnect();
        this.dispatchEvent(new Event("connect"));
      });
      if (this.cleanupMap["deletion"]) this.cleanupMap["deletion"]();
      this.cleanupMap["deletion"] = cleanup;
    }, "onDisconnect");
    const onConnect = /* @__PURE__ */ __name(() => {
      this.terminalInput = document.querySelector("#terminal-input");
      this.terminalElement = document.querySelector("#terminal");
      this.#terminalInputProps = Object.keys(this.terminalInput).find((k) => k.includes("__reactProps"));
      while (this.#awaitConnectQueue.length) this.#awaitConnectQueue.shift()();
      const { cleanup } = watchElForDeletion(this.terminalInput, () => {
        this.terminalInput = null;
        onDisconnect();
        this.dispatchEvent(new Event("disconnect"));
      });
      if (this.cleanupMap["creation"]) this.cleanupMap["creation"]();
      this.cleanupMap["creation"] = cleanup;
    }, "onConnect");
    this.terminalInput = document.querySelector("#terminal-input");
    if (this.terminalInput) onConnect();
    else onDisconnect();
  }
  async connect() {
    if (!this.terminalInput)
      await new Promise((resolve) => this.#awaitConnectQueue.push(() => resolve()));
  }
  async exec(cmd) {
    await this.connect();
    if (!this.terminalInput || !this.#terminalInputProps) throw new Error("Terminal input is undefined");
    this.terminalInput.value = cmd;
    this.terminalInput[this.#terminalInputProps].onChange({ target: this.terminalInput });
    this.terminalInput[this.#terminalInputProps].onKeyDown({ key: "Enter", preventDefault: /* @__PURE__ */ __name(() => null, "preventDefault") });
  }
  async inputKey(key) {
    await this.connect();
    if (!this.terminalInput || !this.#terminalInputProps) throw new Error("Terminal input is undefined");
    this.terminalInput[this.#terminalInputProps].onKeyDown({ key, preventDefault: /* @__PURE__ */ __name(() => null, "preventDefault") });
  }
  async getTerminalLines() {
    await this.connect();
    if (!this.terminalElement) throw new Error("Terminal input is undefined");
    return [...this.terminalElement.children].map((c) => c.cloneNode(true));
  }
  async autoComplete(cmd, suppressTooltip = true) {
    await this.connect();
    const { cleanup } = watchSelectorForCreation('div[role="tooltip"]', (el) => {
      if (suppressTooltip) el.style.display = "none";
    });
    setTimeout(() => cleanup(), 500);
    if (!this.terminalInput || !this.#terminalInputProps) throw new Error("Terminal input is undefined");
    this.terminalInput.value = cmd;
    this.terminalInput[this.#terminalInputProps].onChange({ target: this.terminalInput });
    this.terminalInput[this.#terminalInputProps].onKeyDown({ key: "Tab", preventDefault: /* @__PURE__ */ __name(() => null, "preventDefault") });
    await sleep(0);
    const tooltip = [...document.querySelectorAll('div[role="tooltip"]')].find((d) => d.innerHTML.includes("Possible autocomplete candidates:"));
    const autoComplete = tooltip ? tooltip.firstElementChild.lastElementChild.textContent.split(" ") : [this.terminalInput.value];
    return autoComplete;
  }
  cleanup() {
    for (const key in this.cleanupMap) this.cleanupMap[key]();
  }
};

// src/apps/Plasma/components/HomeMenu.tsx
var import_react4 = __toESM(require_react());

// node_modules/react-icons/lib/iconBase.mjs
var import_react3 = __toESM(require_react(), 1);

// node_modules/react-icons/lib/iconContext.mjs
var import_react2 = __toESM(require_react(), 1);
var DefaultContext = {
  color: void 0,
  size: void 0,
  className: void 0,
  style: void 0,
  attr: void 0
};
var IconContext = import_react2.default.createContext && /* @__PURE__ */ import_react2.default.createContext(DefaultContext);

// node_modules/react-icons/lib/iconBase.mjs
var _excluded = ["attr", "size", "title"];
function _objectWithoutProperties(source, excluded) {
  if (source == null) return {};
  var target = _objectWithoutPropertiesLoose(source, excluded);
  var key, i;
  if (Object.getOwnPropertySymbols) {
    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);
    for (i = 0; i < sourceSymbolKeys.length; i++) {
      key = sourceSymbolKeys[i];
      if (excluded.indexOf(key) >= 0) continue;
      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;
      target[key] = source[key];
    }
  }
  return target;
}
__name(_objectWithoutProperties, "_objectWithoutProperties");
function _objectWithoutPropertiesLoose(source, excluded) {
  if (source == null) return {};
  var target = {};
  for (var key in source) {
    if (Object.prototype.hasOwnProperty.call(source, key)) {
      if (excluded.indexOf(key) >= 0) continue;
      target[key] = source[key];
    }
  }
  return target;
}
__name(_objectWithoutPropertiesLoose, "_objectWithoutPropertiesLoose");
function _extends() {
  _extends = Object.assign ? Object.assign.bind() : function(target) {
    for (var i = 1; i < arguments.length; i++) {
      var source = arguments[i];
      for (var key in source) {
        if (Object.prototype.hasOwnProperty.call(source, key)) {
          target[key] = source[key];
        }
      }
    }
    return target;
  };
  return _extends.apply(this, arguments);
}
__name(_extends, "_extends");
function ownKeys(e, r) {
  var t = Object.keys(e);
  if (Object.getOwnPropertySymbols) {
    var o = Object.getOwnPropertySymbols(e);
    r && (o = o.filter(function(r2) {
      return Object.getOwnPropertyDescriptor(e, r2).enumerable;
    })), t.push.apply(t, o);
  }
  return t;
}
__name(ownKeys, "ownKeys");
function _objectSpread(e) {
  for (var r = 1; r < arguments.length; r++) {
    var t = null != arguments[r] ? arguments[r] : {};
    r % 2 ? ownKeys(Object(t), true).forEach(function(r2) {
      _defineProperty(e, r2, t[r2]);
    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function(r2) {
      Object.defineProperty(e, r2, Object.getOwnPropertyDescriptor(t, r2));
    });
  }
  return e;
}
__name(_objectSpread, "_objectSpread");
function _defineProperty(obj, key, value) {
  key = _toPropertyKey(key);
  if (key in obj) {
    Object.defineProperty(obj, key, { value, enumerable: true, configurable: true, writable: true });
  } else {
    obj[key] = value;
  }
  return obj;
}
__name(_defineProperty, "_defineProperty");
function _toPropertyKey(t) {
  var i = _toPrimitive(t, "string");
  return "symbol" == typeof i ? i : i + "";
}
__name(_toPropertyKey, "_toPropertyKey");
function _toPrimitive(t, r) {
  if ("object" != typeof t || !t) return t;
  var e = t[Symbol.toPrimitive];
  if (void 0 !== e) {
    var i = e.call(t, r || "default");
    if ("object" != typeof i) return i;
    throw new TypeError("@@toPrimitive must return a primitive value.");
  }
  return ("string" === r ? String : Number)(t);
}
__name(_toPrimitive, "_toPrimitive");
function Tree2Element(tree) {
  return tree && tree.map((node, i) => /* @__PURE__ */ import_react3.default.createElement(node.tag, _objectSpread({
    key: i
  }, node.attr), Tree2Element(node.child)));
}
__name(Tree2Element, "Tree2Element");
function GenIcon(data) {
  return (props) => /* @__PURE__ */ import_react3.default.createElement(IconBase, _extends({
    attr: _objectSpread({}, data.attr)
  }, props), Tree2Element(data.child));
}
__name(GenIcon, "GenIcon");
function IconBase(props) {
  var elem = /* @__PURE__ */ __name((conf) => {
    var {
      attr,
      size,
      title
    } = props, svgProps = _objectWithoutProperties(props, _excluded);
    var computedSize = size || conf.size || "1em";
    var className;
    if (conf.className) className = conf.className;
    if (props.className) className = (className ? className + " " : "") + props.className;
    return /* @__PURE__ */ import_react3.default.createElement("svg", _extends({
      stroke: "currentColor",
      fill: "currentColor",
      strokeWidth: "0"
    }, conf.attr, attr, svgProps, {
      className,
      style: _objectSpread(_objectSpread({
        color: props.color || conf.color
      }, conf.style), props.style),
      height: computedSize,
      width: computedSize,
      xmlns: "http://www.w3.org/2000/svg"
    }), title && /* @__PURE__ */ import_react3.default.createElement("title", null, title), props.children);
  }, "elem");
  return IconContext !== void 0 ? /* @__PURE__ */ import_react3.default.createElement(IconContext.Consumer, null, (conf) => elem(conf)) : elem(DefaultContext);
}
__name(IconBase, "IconBase");

// node_modules/react-icons/fa/index.mjs
function FaJs(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 448 512" }, "child": [{ "tag": "path", "attr": { "d": "M0 32v448h448V32H0zm243.8 349.4c0 43.6-25.6 63.5-62.9 63.5-33.7 0-53.2-17.4-63.2-38.5l34.3-20.7c6.6 11.7 12.6 21.6 27.1 21.6 13.8 0 22.6-5.4 22.6-26.5V237.7h42.1v143.7zm99.6 63.5c-39.1 0-64.4-18.6-76.7-43l34.3-19.8c9 14.7 20.8 25.6 41.5 25.6 17.4 0 28.6-8.7 28.6-20.8 0-14.4-11.4-19.5-30.7-28l-10.5-4.5c-30.4-12.9-50.5-29.2-50.5-63.5 0-31.6 24.1-55.6 61.6-55.6 26.8 0 46 9.3 59.8 33.7L368 290c-7.2-12.9-15-18-27.1-18-12.3 0-20.1 7.8-20.1 18 0 12.6 7.8 17.7 25.9 25.6l10.5 4.5c35.8 15.3 55.9 31 55.9 66.2 0 37.8-29.8 58.6-69.7 58.6z" }, "child": [] }] })(props);
}
__name(FaJs, "FaJs");
function FaCog(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 512 512" }, "child": [{ "tag": "path", "attr": { "d": "M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z" }, "child": [] }] })(props);
}
__name(FaCog, "FaCog");
function FaFileCode(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 384 512" }, "child": [{ "tag": "path", "attr": { "d": "M384 121.941V128H256V0h6.059c6.365 0 12.47 2.529 16.971 7.029l97.941 97.941A24.005 24.005 0 0 1 384 121.941zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zM123.206 400.505a5.4 5.4 0 0 1-7.633.246l-64.866-60.812a5.4 5.4 0 0 1 0-7.879l64.866-60.812a5.4 5.4 0 0 1 7.633.246l19.579 20.885a5.4 5.4 0 0 1-.372 7.747L101.65 336l40.763 35.874a5.4 5.4 0 0 1 .372 7.747l-19.579 20.884zm51.295 50.479l-27.453-7.97a5.402 5.402 0 0 1-3.681-6.692l61.44-211.626a5.402 5.402 0 0 1 6.692-3.681l27.452 7.97a5.4 5.4 0 0 1 3.68 6.692l-61.44 211.626a5.397 5.397 0 0 1-6.69 3.681zm160.792-111.045l-64.866 60.812a5.4 5.4 0 0 1-7.633-.246l-19.58-20.885a5.4 5.4 0 0 1 .372-7.747L284.35 336l-40.763-35.874a5.4 5.4 0 0 1-.372-7.747l19.58-20.885a5.4 5.4 0 0 1 7.633-.246l64.866 60.812a5.4 5.4 0 0 1-.001 7.879z" }, "child": [] }] })(props);
}
__name(FaFileCode, "FaFileCode");
function FaFolderOpen(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 576 512" }, "child": [{ "tag": "path", "attr": { "d": "M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z" }, "child": [] }] })(props);
}
__name(FaFolderOpen, "FaFolderOpen");
function FaPen(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 512 512" }, "child": [{ "tag": "path", "attr": { "d": "M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z" }, "child": [] }] })(props);
}
__name(FaPen, "FaPen");
function FaPowerOff(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 512 512" }, "child": [{ "tag": "path", "attr": { "d": "M400 54.1c63 45 104 118.6 104 201.9 0 136.8-110.8 247.7-247.5 248C120 504.3 8.2 393 8 256.4 7.9 173.1 48.9 99.3 111.8 54.2c11.7-8.3 28-4.8 35 7.7L162.6 90c5.9 10.5 3.1 23.8-6.6 31-41.5 30.8-68 79.6-68 134.9-.1 92.3 74.5 168.1 168 168.1 91.6 0 168.6-74.2 168-169.1-.3-51.8-24.7-101.8-68.1-134-9.7-7.2-12.4-20.5-6.5-30.9l15.8-28.1c7-12.4 23.2-16.1 34.8-7.8zM296 264V24c0-13.3-10.7-24-24-24h-32c-13.3 0-24 10.7-24 24v240c0 13.3 10.7 24 24 24h32c13.3 0 24-10.7 24-24z" }, "child": [] }] })(props);
}
__name(FaPowerOff, "FaPowerOff");
function FaTerminal(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 640 512" }, "child": [{ "tag": "path", "attr": { "d": "M257.981 272.971L63.638 467.314c-9.373 9.373-24.569 9.373-33.941 0L7.029 444.647c-9.357-9.357-9.375-24.522-.04-33.901L161.011 256 6.99 101.255c-9.335-9.379-9.317-24.544.04-33.901l22.667-22.667c9.373-9.373 24.569-9.373 33.941 0L257.981 239.03c9.373 9.372 9.373 24.568 0 33.941zM640 456v-32c0-13.255-10.745-24-24-24H312c-13.255 0-24 10.745-24 24v32c0 13.255 10.745 24 24 24h304c13.255 0 24-10.745 24-24z" }, "child": [] }] })(props);
}
__name(FaTerminal, "FaTerminal");

// node_modules/react-icons/fa6/index.mjs
function FaFileLines(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 384 512" }, "child": [{ "tag": "path", "attr": { "d": "M64 0C28.7 0 0 28.7 0 64L0 448c0 35.3 28.7 64 64 64l256 0c35.3 0 64-28.7 64-64l0-288-128 0c-17.7 0-32-14.3-32-32L224 0 64 0zM256 0l0 128 128 0L256 0zM112 256l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z" }, "child": [] }] })(props);
}
__name(FaFileLines, "FaFileLines");
function FaFolderClosed(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 512 512" }, "child": [{ "tag": "path", "attr": { "d": "M448 480L64 480c-35.3 0-64-28.7-64-64L0 192l512 0 0 224c0 35.3-28.7 64-64 64zm64-320L0 160 0 96C0 60.7 28.7 32 64 32l128 0c20.1 0 39.1 9.5 51.2 25.6l19.2 25.6c6 8.1 15.5 12.8 25.6 12.8l160 0c35.3 0 64 28.7 64 64z" }, "child": [] }] })(props);
}
__name(FaFolderClosed, "FaFolderClosed");
function FaRotate(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 512 512" }, "child": [{ "tag": "path", "attr": { "d": "M142.9 142.9c-17.5 17.5-30.1 38-37.8 59.8c-5.9 16.7-24.2 25.4-40.8 19.5s-25.4-24.2-19.5-40.8C55.6 150.7 73.2 122 97.6 97.6c87.2-87.2 228.3-87.5 315.8-1L455 55c6.9-6.9 17.2-8.9 26.2-5.2s14.8 12.5 14.8 22.2l0 128c0 13.3-10.7 24-24 24l-8.4 0c0 0 0 0 0 0L344 224c-9.7 0-18.5-5.8-22.2-14.8s-1.7-19.3 5.2-26.2l41.1-41.1c-62.6-61.5-163.1-61.2-225.3 1zM16 312c0-13.3 10.7-24 24-24l7.6 0 .7 0L168 288c9.7 0 18.5 5.8 22.2 14.8s1.7 19.3-5.2 26.2l-41.1 41.1c62.6 61.5 163.1 61.2 225.3-1c17.5-17.5 30.1-38 37.8-59.8c5.9-16.7 24.2-25.4 40.8-19.5s25.4 24.2 19.5 40.8c-10.8 30.6-28.4 59.3-52.9 83.8c-87.2 87.2-228.3 87.5-315.8 1L57 457c-6.9 6.9-17.2 8.9-26.2 5.2S16 449.7 16 440l0-119.6 0-.7 0-7.6z" }, "child": [] }] })(props);
}
__name(FaRotate, "FaRotate");
function FaTrashCan(props) {
  return GenIcon({ "tag": "svg", "attr": { "viewBox": "0 0 448 512" }, "child": [{ "tag": "path", "attr": { "d": "M135.2 17.7C140.6 6.8 151.7 0 163.8 0L284.2 0c12.1 0 23.2 6.8 28.6 17.7L320 32l96 0c17.7 0 32 14.3 32 32s-14.3 32-32 32L32 96C14.3 96 0 81.7 0 64S14.3 32 32 32l96 0 7.2-14.3zM32 128l384 0 0 320c0 35.3-28.7 64-64 64L96 512c-35.3 0-64-28.7-64-64l0-320zm96 64c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16s16-7.2 16-16l0-224c0-8.8-7.2-16-16-16z" }, "child": [] }] })(props);
}
__name(FaTrashCan, "FaTrashCan");

// src/apps/Plasma/components/HomeMenu.tsx
function HomeMenu({}) {
  "use run";
  const terminate = (0, import_react4.useContext)(TerminateContext);
  const config = (0, import_react4.useContext)(ConfigContext);
  const ns = (0, import_react4.useContext)(NetscriptContext);
  const addCleanup = (0, import_react4.useContext)(CleanupContext);
  const entries = [...config.get("homeapps")?.map((a) => ({ path: a, Icon: FaJs })) ?? []];
  if (config.get("explorer")) {
    entries.push({
      path: config.get("explorer"),
      Icon: FaFolderOpen
    });
  }
  if (config.get("terminal")) {
    entries.push({
      path: config.get("terminal"),
      Icon: FaTerminal
    });
  }
  return /* @__PURE__ */ import_react4.default.createElement("div", { className: "homemenu plasma-box-inline" }, entries.map(
    ({ path, Icon }) => (console.log(), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-button plasma-box-top", onClick: () => {
      ns.run(path);
    } }, /* @__PURE__ */ import_react4.default.createElement(Icon, null), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-center" }, path.split(/(.*)\//).at(-1).split(/(.*)\./, 2)[1])))
  ), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-button plasma-box-top", onClick: () => {
    const term = new Terminal(ns);
    term.exec(`home;nano ${PLASMA_CONFIG_FILE}`);
    term.cleanup();
  } }, /* @__PURE__ */ import_react4.default.createElement(FaCog, null), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-center" }, "Settings")), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-button plasma-box-top", onClick: async () => {
    terminate();
    addCleanup(() => {
      ns.run(ns.getScriptName());
    });
  } }, /* @__PURE__ */ import_react4.default.createElement(FaRotate, null), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-center" }, "Reboot")), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-button plasma-box-top", onClick: () => terminate() }, /* @__PURE__ */ import_react4.default.createElement(FaPowerOff, null), /* @__PURE__ */ import_react4.default.createElement("span", { className: "plasma-center" }, "Shutdown")));
}
__name(HomeMenu, "HomeMenu");

// src/apps/Plasma/components/HomeButton.tsx
var import_react5 = __toESM(require_react());
function HomeButton({}) {
  const [showMenu, setShowMenu] = (0, import_react5.useState)(false);
  return /* @__PURE__ */ import_react5.default.createElement(import_react5.default.Fragment, null, /* @__PURE__ */ import_react5.default.createElement(
    "div",
    {
      className: "taskbar-homebutton plasma-button plasma-box-inline",
      onClick: () => {
        setShowMenu(!showMenu);
        if (!showMenu) setTimeout(() => document.querySelector("html")?.addEventListener("click", () => {
          setShowMenu(false);
        }, { once: true }), 0);
      }
    },
    /* @__PURE__ */ import_react5.default.createElement("div", { dangerouslySetInnerHTML: { __html: bitburner_logo_default } })
  ), !showMenu || /* @__PURE__ */ import_react5.default.createElement(HomeMenu, null));
}
__name(HomeButton, "HomeButton");

// src/apps/Plasma/components/Taskbar.tsx
var import_react6 = __toESM(require_react());
function Taskbar({}) {
  const [clock, setClock] = (0, import_react6.useState)(Date.now());
  (0, import_react6.useEffect)(() => {
    const interval = setInterval(() => {
      setClock(Date.now());
    }, 1e3);
    return () => {
      clearInterval(interval);
    };
  }, []);
  return /* @__PURE__ */ import_react6.default.createElement(import_react6.default.Fragment, null, /* @__PURE__ */ import_react6.default.createElement("div", { className: "taskbar" }, /* @__PURE__ */ import_react6.default.createElement(HomeButton, null), /* @__PURE__ */ import_react6.default.createElement("div", { className: "taskbar-windows" }), /* @__PURE__ */ import_react6.default.createElement("span", { className: "taskbar-date plasma-box-inline" }, /* @__PURE__ */ import_react6.default.createElement("div", null, new Date(clock).toLocaleTimeString().slice(0, -3)), /* @__PURE__ */ import_react6.default.createElement("div", null, new Date(clock).toLocaleDateString()))));
}
__name(Taskbar, "Taskbar");

// src/apps/Plasma/lib/MapObject.ts
function mapObject(obj, mapFunction) {
  const accumulator = {};
  Object.entries(obj).forEach(([key, val]) => Object.assign(accumulator, mapFunction(key, val)));
  return accumulator;
}
__name(mapObject, "mapObject");

// src/lib/Network.ts
function getConnectionPath(ns, server) {
  const path = [server, ns.scan(server)[0]];
  while (path.at(-1) != "home") path.push(ns.scan(path.at(-1))[0]);
  return path.toReversed();
}
__name(getConnectionPath, "getConnectionPath");

// src/lib/FileSystem.ts
function readDir(ns, path) {
  "use ls";
  try {
    const [server, ...directory] = path.split("/");
    const filesystemTree = ns.ls(server).reduce((prev, cur) => {
      const path2 = cur.split("/");
      let node = prev;
      while (path2.length) {
        const curNode = path2.shift();
        node[curNode] ??= {};
        node = node[curNode];
      }
      ;
      return prev;
    }, {});
    const folder = directory.reduce((prev, cur) => prev[cur], filesystemTree);
    const filesWithType = Object.keys(folder).map((key) => ({
      name: key,
      type: Object.keys(folder[key]).length ? "folder" : "file"
    }));
    return filesWithType;
  } catch {
    return null;
  }
}
__name(readDir, "readDir");
function readDirRecursive(ns, path) {
  const content = readDir(ns, path);
  if (!content) throw new Error("Path does not exists: " + path);
  return content.flatMap((file) => file.type == "folder" ? readDirRecursive(ns, `${path}/${file.name}`).flat() : file).map((f) => ({ ...f, path: f.path ?? path }));
}
__name(readDirRecursive, "readDirRecursive");
function readFile(ns, path) {
  "use getHostname";
  "use scp";
  "use rm";
  const [server, file] = path.split(/\/(.*)/, 2);
  if (server == ns.getHostname()) {
    return ns.read(file);
  }
  ns.scp(file, ns.getHostname(), server);
  const content = ns.read(file);
  ns.rm(file);
  return content;
}
__name(readFile, "readFile");
function moveFile(ns, source, destination) {
  const sourceExtension = source.split(".").at(-1);
  if (sourceExtension != "js" && sourceExtension != "txt") {
    throw new Error("only scripts and textfiles can be moved");
  }
  const [sourceServer, sourceFile] = source.split(/\/(.*)/, 2);
  const [destinationServer, destinationFile] = destination.split(/\/(.*)/, 2);
  if (sourceServer == destinationServer) ns.mv(sourceServer, sourceFile, destinationFile);
  else {
    copyFile(ns, source, destination);
    deleteFile(ns, source);
  }
}
__name(moveFile, "moveFile");
function moveFolder(ns, source, destination) {
  const folder = readDirRecursive(ns, source);
  for (const file of folder) {
    moveFile(ns, `${file.path}/${file.name}`, `${file.path.replace(source, destination)}/${file.name}`);
  }
}
__name(moveFolder, "moveFolder");
function copyFile(ns, source, destination) {
  "use scp";
  const sourceExtension = source.split(".").at(-1);
  if (sourceExtension != "js" && sourceExtension != "txt") {
    throw new Error("only scripts and textfiles can be moved");
  }
  const [sourceServer, sourceFile] = source.split(/\/(.*)/, 2);
  const [destinationServer, destinationFile] = destination.split(/\/(.*)/, 2);
  if (!sourceFile) {
    throw new Error("source is not a file");
  }
  if (!destinationFile) {
    throw new Error("destination is not a file");
  }
  if (sourceServer == destinationServer) ns.write(destinationFile, ns.read(sourceFile), "w");
  else {
    ns.scp(sourceFile, destinationServer, sourceServer);
    ns.mv(destinationServer, sourceFile, destinationFile);
  }
  ;
}
__name(copyFile, "copyFile");
function deleteFile(ns, file) {
  "use rm";
  const [server, path] = file.split(/\/(.*)/, 2);
  ns.rm(path, server);
}
__name(deleteFile, "deleteFile");
function deleteFolder(ns, path) {
  const folder = readDirRecursive(ns, path);
  for (const file of folder) {
    deleteFile(ns, `${file.path}/${file.name}`);
  }
}
__name(deleteFolder, "deleteFolder");
function transferFile(ns, source, destination, copy) {
  if (copy) copyFile(ns, source, destination);
  else moveFile(ns, source, destination);
}
__name(transferFile, "transferFile");
function transferFolder(ns, source, destination, copy) {
  const folder = readDirRecursive(ns, source);
  for (const file of folder) {
    transferFile(ns, `${file.path}/${file.name}`, `${file.path.replace(source, destination)}/${file.name}`, copy);
  }
}
__name(transferFolder, "transferFolder");

// src/lib/components/FileGrid/index.tsx
var import_react11 = __toESM(require_react());
var import_react12 = __toESM(require_react());

// src/lib/components/List.tsx
var import_react7 = __toESM(require_react());
function List({ data, li }) {
  return /* @__PURE__ */ import_react7.default.createElement(import_react7.default.Fragment, null, data?.map((c) => import_react7.default.createElement(li, { ...c, key: JSON.stringify(c) })));
}
__name(List, "List");

// src/lib/components/DropTarget.tsx
var import_react8 = __toESM(require_react());
function DropTarget({ accept, onDragEnter, onDragOver, ...attr }) {
  const shouldAccept = /* @__PURE__ */ __name((types) => {
    const valid = typeof accept == "string" ? [accept] : accept;
    return valid.some((v) => types.includes(v));
  }, "shouldAccept");
  return /* @__PURE__ */ import_react8.default.createElement(
    "div",
    {
      draggable: true,
      "data-drag-accept": accept,
      onDragEnter: (e) => {
        if (shouldAccept(e.dataTransfer.types)) e.preventDefault();
        if (onDragEnter) onDragEnter(e);
      },
      onDragOver: (e) => {
        if (shouldAccept(e.dataTransfer.types)) e.preventDefault();
        if (onDragOver) onDragOver(e);
      },
      ...attr
    }
  );
}
__name(DropTarget, "DropTarget");

// src/lib/components/FileTile/index.tsx
var import_react10 = __toESM(require_react());

// src/lib/components/DragTarget.tsx
var import_react9 = __toESM(require_react());
function DragTarget({ group, data, onDragStart, ...attr }) {
  return /* @__PURE__ */ import_react9.default.createElement(
    "div",
    {
      draggable: true,
      "data-drag-group": group,
      "data-drag-data": data,
      onDragStart: (e) => {
        e.dataTransfer.setData(group, e.currentTarget.id);
        e.dataTransfer.setData("data", data);
        if (onDragStart) onDragStart(e);
      },
      ...attr
    }
  );
}
__name(DragTarget, "DragTarget");

// src/lib/components/FileTile/index.tsx
var DoubleClickFileContext = (0, import_react10.createContext)(() => {
});
var FileIcons = {
  "js": /* @__PURE__ */ __name(() => /* @__PURE__ */ import_react10.default.createElement(FaFileCode, null), "js"),
  "exe": /* @__PURE__ */ __name(() => /* @__PURE__ */ import_react10.default.createElement(FaFileCode, null), "exe"),
  "txt": /* @__PURE__ */ __name(() => /* @__PURE__ */ import_react10.default.createElement(FaFileLines, null), "txt"),
  "msg": /* @__PURE__ */ __name(() => /* @__PURE__ */ import_react10.default.createElement(FaFileLines, null), "msg"),
  "folder": /* @__PURE__ */ __name(() => /* @__PURE__ */ import_react10.default.createElement(FaFolderClosed, null), "folder")
};
function FileTile({ file, path }) {
  const ns = (0, import_react10.useContext)(NetscriptContext);
  const type = file.type == "file" ? file.name.split(".").at(-1) : "folder";
  const Icon = FileIcons[type] ?? FileIcons["txt"];
  const onDoubleClick = (0, import_react10.useContext)(DoubleClickFileContext);
  return /* @__PURE__ */ import_react10.default.createElement(
    DragTarget,
    {
      className: "file-tile",
      group: `${type != "folder" ? "file" : "folder"}`,
      data: `${path}/${file.name}`,
      onDoubleClick: (e) => onDoubleClick(e, { name: file.name, path, type }),
      onDragEnter: (e) => {
        if (e.dataTransfer.types.includes("file") && type == "folder") e.preventDefault();
      },
      onDragOver: (e) => {
        if (e.dataTransfer.types.includes("file") && type == "folder") e.preventDefault();
      },
      onDrop: (e) => {
        if (type != "folder") return;
        const [sourceServer, sourceFile] = e.dataTransfer.getData("data").split(/\/(.*)/, 2);
        const [targetServer] = path.split("/");
        transferFile(
          ns,
          `${sourceServer}/${sourceFile}`,
          `${path}/${file.name}/${sourceFile.split("/").at(-1)}`,
          sourceServer != targetServer
        );
      }
    },
    /* @__PURE__ */ import_react10.default.createElement(Icon, null),
    /* @__PURE__ */ import_react10.default.createElement(
      "div",
      {
        className: "file-name",
        spellCheck: false,
        onDoubleClick: (e) => {
          e.stopPropagation();
          const el = e.currentTarget;
          el.contentEditable = "true";
          el.focus();
          const keydownHandler = /* @__PURE__ */ __name((e2) => {
            if (e2.key == "Enter") {
              el.contentEditable = "false";
              window.focus();
            }
          }, "keydownHandler");
          el.addEventListener("keydown", keydownHandler);
          el.addEventListener("focusout", ({ currentTarget }) => {
            const newName = currentTarget.textContent;
            if (newName == file.name) return;
            try {
              if (type == "folder")
                moveFolder(ns, `${path}/${file.name}`, `${path}/${newName}`);
              else
                moveFile(ns, `${path}/${file.name}`, `${path}/${newName}`);
            } catch (e2) {
              console.log({ e: e2 });
              ns.toast(e2.name, "error");
            }
            el.removeEventListener("keydown", keydownHandler);
          }, { once: true });
        }
      },
      file.name
    ),
    /* @__PURE__ */ import_react10.default.createElement("div", { className: "file-action-buttons" }, ["js", "txt"].includes(type) ? /* @__PURE__ */ import_react10.default.createElement(
      FaPen,
      {
        style: { cursor: "pointer", fontSize: "0.9em" },
        onClick: async () => {
          const term = new Terminal(ns);
          const [server, filepath] = `${path}/${file.name}`.split(/\/(.*)/, 2);
          if (!term.terminalInput) return ns.toast("Editing can only be triggered when the terminal tab is selected", "warning");
          term.exec(getConnectionPath(ns, server).reduce((prev, cur) => prev + `connect ${cur};`, ""));
          term.exec(`nano ${filepath}`);
          term.cleanup();
        }
      }
    ) : /* @__PURE__ */ import_react10.default.createElement("span", null), ["js", "txt", "folder"].includes(type) ? /* @__PURE__ */ import_react10.default.createElement(
      FaTrashCan,
      {
        style: { cursor: "pointer", fontSize: "0.9em" },
        onClick: async () => {
          if (!await ns.prompt(`Are you sure you want to delete ${path}/${file.name}?`, { type: "boolean" })) return;
          if (type == "folder")
            deleteFolder(ns, `${path}/${file.name}`);
          else
            deleteFile(ns, `${path}/${file.name}`);
        }
      }
    ) : void 0)
  );
}
__name(FileTile, "FileTile");

// src/lib/components/FileGrid/index.tsx
function FileGrid({ path, files }) {
  const ns = (0, import_react11.useContext)(NetscriptContext);
  if (!files || !path) return void 0;
  return /* @__PURE__ */ import_react12.default.createElement(import_react12.default.Fragment, null, /* @__PURE__ */ import_react12.default.createElement(
    DropTarget,
    {
      accept: ["file", "folder"],
      className: "file-grid-drop-target",
      onDrop: (e) => {
        const [sourceServer, sourceFile] = e.dataTransfer.getData("data").split(/\/(.*)/, 2);
        const [targetServer] = path.split("/");
        if (e.dataTransfer.types.includes("file"))
          transferFile(
            ns,
            `${sourceServer}/${sourceFile}`,
            `${path}/${sourceFile.split("/").at(-1)}`,
            sourceServer != targetServer
          );
        else {
          transferFolder(
            ns,
            `${sourceServer}/${sourceFile}`,
            `${path}/${sourceFile.split("/").at(-1)}`,
            sourceServer != targetServer
          );
        }
      }
    },
    /* @__PURE__ */ import_react12.default.createElement("div", { className: "file-grid" }, /* @__PURE__ */ import_react12.default.createElement(List, { data: files.filter((f) => !f.name.startsWith(".")).map((file) => ({ file, path })), li: FileTile }))
  ));
}
__name(FileGrid, "FileGrid");

// src/apps/Plasma/components/Desktop.tsx
var import_react13 = __toESM(require_react());
function Desktop() {
  "use run";
  const ns = (0, import_react13.useContext)(NetscriptContext);
  const config = (0, import_react13.useContext)(ConfigContext);
  const [_, reload] = (0, import_react13.useState)(true);
  (0, import_react13.useEffect)(() => {
    const timeout = setTimeout(() => reload(!_), 500);
    return () => clearTimeout(timeout);
  });
  const explorerScript = config.get("explorer");
  return /* @__PURE__ */ import_react13.default.createElement("div", { className: "plasma-desktop" }, /* @__PURE__ */ import_react13.default.createElement(DoubleClickFileContext.Provider, { value: (e, { type, name }) => {
    switch (type) {
      case "js":
        ns.run(name);
        break;
      case "folder":
        explorerScript && ns.run(explorerScript, void 0, `home/${name}`);
        break;
      case "txt":
        ns.alert(readFile(ns, `home/${name}`));
        break;
      case "exe":
        ns.toast(".exe files can only be run from the terminal", "error");
        break;
      default:
        ns.toast(`This filetype is not supported (${type})`, "error");
        break;
    }
  } }, /* @__PURE__ */ import_react13.default.createElement(FileGrid, { path: "home", files: readDir(ns, "home") })));
}
__name(Desktop, "Desktop");

// src/apps/Plasma/DesktopEnviroment.tsx
var import_react14 = __toESM(require_react());
function DesktopEnviroment() {
  const ns = (0, import_react14.useContext)(NetscriptContext);
  const theme = mapObject(ns.ui.getTheme(), (key, value) => ({
    ["--" + key]: value
  }));
  return /* @__PURE__ */ import_react14.default.createElement(import_react14.default.Fragment, null, /* @__PURE__ */ import_react14.default.createElement("div", { className: "desktop-enviroment", style: theme }, /* @__PURE__ */ import_react14.default.createElement(Desktop, null), /* @__PURE__ */ import_react14.default.createElement(Taskbar, null)));
}
__name(DesktopEnviroment, "DesktopEnviroment");

// src/apps/Plasma/main.tsx
var import_react_dom = __toESM(require_react_dom());
var import_react15 = __toESM(require_react());
var ConfigContext = (0, import_react15.createContext)(null);
var PLASMA_CONFIG_FILE = ".plasmaconf.json";
async function Plasma(ns) {
  "use getHostname";
  if (ns.getHostname() != "home") {
    throw new Error("Plasma can not run on servers");
  }
  if (!ns.fileExists(PLASMA_CONFIG_FILE)) {
    ns.write(PLASMA_CONFIG_FILE, JSON.stringify({
      explorer: "Dolphin.js",
      terminal: "Konsole.js",
      homeapps: []
    }));
  }
  const cleanupCallbacks = [];
  const addCleanup = /* @__PURE__ */ __name((f) => cleanupCallbacks.push(f), "addCleanup");
  return new Promise((resolve) => {
    ns.atExit(() => {
      ns.tprint("Terminated");
      "use clearTerminal";
      ns.ui.clearTerminal();
      cleanupCallbacks.forEach((c) => c());
      resolve();
    });
    const el = [...document.querySelector("#root").children].filter((el2) => !el2.classList.contains("react-draggable") && el2.id != "#unclickable")[0];
    const config = {
      __data: JSON.parse(ns.read(PLASMA_CONFIG_FILE)),
      get: /* @__PURE__ */ __name(function(value) {
        return this.__data[value];
      }, "get"),
      set: /* @__PURE__ */ __name(function(key, value) {
        this.__data[key] = value;
        ns.write(PLASMA_CONFIG_FILE, JSON.stringify(this.__data));
      }, "set")
    };
    if (!config.get("terminal") || !ns.fileExists(config.get("terminal"))) {
      ns.toast("No terminal app was set!", "error");
    }
    if (!config.get("explorer") || !ns.fileExists(config.get("explorer"))) {
      ns.toast("No file explorer app was set!", "error");
    }
    import_react_dom.default.render(
      /* @__PURE__ */ import_react15.default.createElement(NetscriptContext.Provider, { value: ns }, /* @__PURE__ */ import_react15.default.createElement(CleanupContext.Provider, { value: addCleanup }, /* @__PURE__ */ import_react15.default.createElement(TerminateContext.Provider, { value: resolve }, /* @__PURE__ */ import_react15.default.createElement(ConfigContext.Provider, { value: config }, /* @__PURE__ */ import_react15.default.createElement(DesktopEnviroment, null))))),
      el
    );
  });
}
__name(Plasma, "Plasma");
export {
  Plasma as main
};
